-- ============================================
-- SCHEMA: Forex Quiz Mini App
-- Supabase / PostgreSQL
-- 3 —Ç–∞–±–ª–∏—Ü—ã ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –∏ –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ
-- ============================================

-- –í–æ–ø—Ä–æ—Å—ã –∫–≤–∏–∑–∞
CREATE TABLE IF NOT EXISTS quiz_questions (
  id              SERIAL PRIMARY KEY,
  question_text   TEXT        NOT NULL,
  options         JSONB       NOT NULL,      -- ["–í–∞—Ä–∏–∞–Ω—Ç A", "–í–∞—Ä–∏–∞–Ω—Ç B", "–í–∞—Ä–∏–∞–Ω—Ç C", "–í–∞—Ä–∏–∞–Ω—Ç D"]
  correct_index   SMALLINT    NOT NULL,      -- 0-3
  explanation     TEXT,                      -- –ø–æ—è—Å–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞
  is_active       BOOLEAN     DEFAULT TRUE,
  created_at      TIMESTAMPTZ DEFAULT NOW()
);

-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–≤–∏–∑–∞
CREATE TABLE IF NOT EXISTS quiz_results (
  id            SERIAL PRIMARY KEY,
  tg_user_id    BIGINT,                      -- Telegram user ID (–µ—Å–ª–∏ –µ—Å—Ç—å)
  tg_username   TEXT,
  score         SMALLINT    NOT NULL,
  total         SMALLINT    NOT NULL,
  answers       JSONB,                       -- [{question_id, chosen, correct, is_correct}]
  completed_at  TIMESTAMPTZ DEFAULT NOW()
);

-- –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
CREATE TABLE IF NOT EXISTS feedback (
  id            SERIAL PRIMARY KEY,
  tg_user_id    BIGINT,
  name          TEXT        NOT NULL,
  message       TEXT        NOT NULL,
  quiz_score    SMALLINT,                    -- —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–≤–∏–∑–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ
  created_at    TIMESTAMPTZ DEFAULT NOW()
);

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX IF NOT EXISTS idx_quiz_results_tg  ON quiz_results(tg_user_id);
CREATE INDEX IF NOT EXISTS idx_feedback_created ON feedback(created_at DESC);

-- ============================================
-- SEED: 10 –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Äî —Ñ–æ—Ä–µ–∫—Å –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏
-- ============================================
INSERT INTO quiz_questions (question_text, options, correct_index, explanation) VALUES

('üí± –ß—Ç–æ —Ç–∞–∫–æ–µ Forex (Foreign Exchange)?',
 '["–§–æ–Ω–¥–æ–≤–∞—è –±–∏—Ä–∂–∞ –∞–∫—Ü–∏–π", "–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π —Ä—ã–Ω–æ–∫ –æ–±–º–µ–Ω–∞ –≤–∞–ª—é—Ç", "–†—ã–Ω–æ–∫ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç", "–¢–æ–≤–∞—Ä–Ω–æ-—Å—ã—Ä—å–µ–≤–∞—è –±–∏—Ä–∂–∞"]',
 1,
 'Forex ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–π –¥–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ä—ã–Ω–æ–∫ –æ–±–º–µ–Ω–∞ –≤–∞–ª—é—Ç. –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ–±–æ—Ä–æ—Ç –ø—Ä–µ–≤—ã—à–∞–µ—Ç $7 —Ç—Ä–ª–Ω, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –∫—Ä—É–ø–Ω–µ–π—à–∏–º —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º —Ä—ã–Ω–∫–æ–º –≤ –º–∏—Ä–µ.'),

('üìä –ß—Ç–æ —Ç–∞–∫–æ–µ ¬´–ø–∏–ø—Å¬ª (pip) –≤ —Ç—Ä–µ–π–¥–∏–Ω–≥–µ?',
 '["–†–∞–∑–º–µ—Ä –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ –ø–ª–µ—á–∞", "–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã –≤–∞–ª—é—Ç–Ω–æ–π –ø–∞—Ä—ã", "–ö–æ–º–∏—Å—Å–∏—è –±—Ä–æ–∫–µ—Ä–∞", "–¢–∏–ø —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –æ—Ä–¥–µ—Ä–∞"]',
 1,
 '–ü–∏–ø—Å ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ—Ç–∏—Ä–æ–≤–∫–∏. –î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø–∞—Ä —ç—Ç–æ 0.0001 (4-–π –∑–Ω–∞–∫ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π). –ù–∞–ø—Ä–∏–º–µ—Ä, EUR/USD –≤—ã—Ä–æ—Å —Å 1.1000 –¥–æ 1.1001 ‚Äî —ç—Ç–æ 1 –ø–∏–ø—Å.'),

('‚öñÔ∏è –ß—Ç–æ —Ç–∞–∫–æ–µ –∫—Ä–µ–¥–∏—Ç–Ω–æ–µ –ø–ª–µ—á–æ (Leverage)?',
 '["–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∏–±—ã–ª–∏ –±—Ä–æ–∫–µ—Ä–∞", "–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–µ–π —Å–≤–µ—Ä—Ö –¥–µ–ø–æ–∑–∏—Ç–∞", "–¢–∏–ø –≤–∞–ª—é—Ç–Ω–æ–π –ø–∞—Ä—ã", "–°–≤–æ–ø –∑–∞ –ø–µ—Ä–µ–Ω–æ—Å –ø–æ–∑–∏—Ü–∏–∏"]',
 1,
 '–ö—Ä–µ–¥–∏—Ç–Ω–æ–µ –ø–ª–µ—á–æ 1:100 –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω–∞ $100 –¥–µ–ø–æ–∑–∏—Ç–∞ –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –ø–æ–∑–∏—Ü–∏—é –Ω–∞ $10 000. –≠—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∫–∞–∫ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å, —Ç–∞–∫ –∏ —É–±—ã—Ç–∫–∏.'),

('üè¶ –ß—Ç–æ —Ç–∞–∫–æ–µ –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ –ø–æ—Ä—Ç—Ñ–µ–ª—è?',
 '["–í–ª–æ–∂–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Ä–µ–¥—Å—Ç–≤ –≤ –æ–¥–∏–Ω –∞–∫—Ç–∏–≤", "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞–ø–∏—Ç–∞–ª–∞ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –∞–∫—Ç–∏–≤–∞–º–∏", "–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è", "–ú–µ—Ç–æ–¥ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞"]',
 1,
 '–î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ –∑–∞ —Å—á—ë—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–ª–æ–∂–µ–Ω–∏–π –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∞–∫—Ç–∏–≤–∞–º–∏, —Å–µ–∫—Ç–æ—Ä–∞–º–∏ –∏–ª–∏ —Ä–µ–≥–∏–æ–Ω–∞–º–∏. ¬´–ù–µ –∫–ª–∞–¥–∏—Ç–µ –≤—Å–µ —è–π—Ü–∞ –≤ –æ–¥–Ω—É –∫–æ—Ä–∑–∏–Ω—É¬ª.'),

('üìà –ß—Ç–æ —Ç–∞–∫–æ–µ ¬´–±—ã—á–∏–π¬ª —Ä—ã–Ω–æ–∫ (Bull Market)?',
 '["–†—ã–Ω–æ–∫ —Å –ø–∞–¥–∞—é—â–∏–º–∏ —Ü–µ–Ω–∞–º–∏", "–í—ã—Å–æ–∫–æ–≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã–π —Ä—ã–Ω–æ–∫", "–†—ã–Ω–æ–∫ —Å —É—Å—Ç–æ–π—á–∏–≤—ã–º —Ä–æ—Å—Ç–æ–º —Ü–µ–Ω", "–ë–æ–∫–æ–≤–æ–π —Ä—ã–Ω–æ–∫"]',
 2,
 'Bull Market ‚Äî –ø–µ—Ä–∏–æ–¥ —Ä–æ—Å—Ç–∞ —Ü–µ–Ω –Ω–∞ 20%+ –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –º–∏–Ω–∏–º—É–º–æ–≤. –ë—ã–∫–∏ —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—Ç —Ä–æ—Å—Ç: —Ä–æ–≥–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –≤–≤–µ—Ä—Ö. –ü—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ—Å—Ç—å ‚Äî ¬´–º–µ–¥–≤–µ–∂–∏–π¬ª —Ä—ã–Ω–æ–∫ (Bear Market).'),

('üõë –ß—Ç–æ —Ç–∞–∫–æ–µ Stop Loss?',
 '["–û—Ä–¥–µ—Ä –Ω–∞ —Ñ–∏–∫—Å–∞—Ü–∏—é –ø—Ä–∏–±—ã–ª–∏", "–û—Ä–¥–µ—Ä –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —É–±—ã—Ç–æ—á–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏", "–†–∞–∑–º–µ—Ä –ª–æ—Ç–∞ –≤ —Å–¥–µ–ª–∫–µ", "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–µ–ø–æ–∑–∏—Ç"]',
 1,
 'Stop Loss ‚Äî –∑–∞—â–∏—Ç–Ω—ã–π –æ—Ä–¥–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è —É–±—ã—Ç–∫–æ–≤. –ö–ª—é—á–µ–≤–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏.'),

('üí∞ –ß—Ç–æ —Ç–∞–∫–æ–µ ETF (Exchange-Traded Fund)?',
 '["–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞", "–ë–∏—Ä–∂–µ–≤–æ–π —Ñ–æ–Ω–¥, —Ç–æ—Ä–≥—É–µ–º—ã–π –∫–∞–∫ –∞–∫—Ü–∏—è", "–¢–∏–ø –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã", "–ú–µ–∂–±–∞–Ω–∫–æ–≤—Å–∫–∞—è —Å—Ç–∞–≤–∫–∞"]',
 1,
 'ETF ‚Äî —Ñ–æ–Ω–¥, –∞–∫—Ü–∏–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ç–æ—Ä–≥—É—é—Ç—Å—è –Ω–∞ –±–∏—Ä–∂–µ –∫–∞–∫ –æ–±—ã—á–Ω—ã–µ –∞–∫—Ü–∏–∏. –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ä–∞–∑—É –≤ –∫–æ—Ä–∑–∏–Ω—É –∞–∫—Ç–∏–≤–æ–≤ (–∏–Ω–¥–µ–∫—Å S&P 500, –∑–æ–ª–æ—Ç–æ, —Å–µ–∫—Ç–æ—Ä IT –∏ –¥—Ä.).'),

('üìâ –ß—Ç–æ –∏–∑–º–µ—Ä—è–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –∞–∫—Ç–∏–≤–∞?',
 '["–û–±—ä—ë–º —Ç–æ—Ä–≥–æ–≤ –∑–∞ –¥–µ–Ω—å", "–°–∫–æ—Ä–æ—Å—Ç—å –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–æ–≤", "–°—Ç–µ–ø–µ–Ω—å –∫–æ–ª–µ–±–∞–Ω–∏—è —Ü–µ–Ω—ã –∑–∞ –ø–µ—Ä–∏–æ–¥", "–†–∞–∑–Ω–∏—Ü—É bid/ask"]',
 2,
 '–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –º–µ—Ä–∞ —Ä–∞–∑–±—Ä–æ—Å–∞ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏. –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å = –±–æ–ª—å—à–∏–µ —Ü–µ–Ω–æ–≤—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è = –ø–æ–≤—ã—à–µ–Ω–Ω—ã–π —Ä–∏—Å–∫ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –ø—Ä–∏–±—ã–ª–∏.'),

('üåç –ö–∞–∫–∞—è –≤–∞–ª—é—Ç–Ω–∞—è –ø–∞—Ä–∞ —Å–∞–º–∞—è —Ç–æ—Ä–≥—É–µ–º–∞—è –≤ –º–∏—Ä–µ?',
 '["GBP/USD", "USD/JPY", "EUR/USD", "AUD/USD"]',
 2,
 'EUR/USD ‚Äî ¬´–º–∞–∂–æ—Ä ‚Ññ1¬ª, —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–∫–æ–ª–æ 28% –≤—Å–µ–≥–æ –æ–±–æ—Ä–æ—Ç–∞ —Ñ–æ—Ä–µ–∫—Å. –í—ã—Å–æ–∫–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Å–ø—Ä–µ–¥—ã, –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ ‚Äî –∏–¥–µ–∞–ª –¥–ª—è —Ç—Ä–µ–π–¥–µ—Ä–æ–≤.'),

('üéØ –ß—Ç–æ —Ç–∞–∫–æ–µ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑?',
 '["–ê–Ω–∞–ª–∏–∑ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —Ü–µ–Ω—ã", "–û—Ü–µ–Ω–∫–∞ –∞–∫—Ç–∏–≤–∞ —á–µ—Ä–µ–∑ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ", "–ê–Ω–∞–ª–∏–∑ –æ–±—ä—ë–º–æ–≤ —Ç–æ—Ä–≥–æ–≤", "–ò–∑—É—á–µ–Ω–∏–µ —Å–µ–Ω—Ç–∏–º–µ–Ω—Ç–∞ —Ä—ã–Ω–∫–∞"]',
 1,
 '–§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –∞–∫—Ç–∏–≤–∞ —á–µ—Ä–µ–∑ –º–∞–∫—Ä–æ—ç–∫–æ–Ω–æ–º–∏–∫—É, —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å, –Ω–æ–≤–æ—Å—Ç–∏ –∏ –æ—Ç—Ä–∞—Å–ª–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π.');
